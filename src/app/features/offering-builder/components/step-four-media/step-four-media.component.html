<div class="step-container">
    <div class="main-layout">
        <div class="editor-side">
            <div class="editor-card">
                <div class="heading-section">
                    <h1>Images &amp; Media</h1>
                    <p class="heading-sub">Add images to your offering</p>
                </div>
                <h2 class="section-title">Add Images</h2>

                <div class="media-grid">
                    <div class="thumbnail-block">
                        <span class="field-label">Thumbnail</span>
                        <div class="thumbnail-upload" (click)="thumbnailInput.click()">
                            <div *ngIf="state.offering().thumbnail" class="thumbnail-preview-wrap">
                                <img [src]="state.offering().thumbnail" class="thumbnail-preview"
                                    alt="Thumbnail preview">
                            </div>
                            <div *ngIf="!state.offering().thumbnail" class="upload-placeholder">
                                <span class="material-icons" style="font-size: 32px;">image</span>
                                <span class="upload-text">Drop or click to upload Thumbnail Image</span>
                                <span class="upload-subtext">.PNG, .JPG and .WEBP supported</span>
                            </div>
                            <input #thumbnailInput type="file" hidden
                                accept=".png,.jpg,.jpeg,.webp,image/png,image/jpeg,image/webp"
                                (change)="onThumbnailFileChange($event)">
                        </div>
                    </div>

                    <div class="gallery-column">
                        <span class="field-label">More Gallery Images</span>
                        <div class="gallery-slot" (click)="galleryInput1.click()">
                            <ng-container *ngIf="galleryImages[0]; else addPlaceholder1">
                                <img [src]="galleryImages[0]" class="gallery-preview" alt="Gallery image 1">
                            </ng-container>
                            <ng-template #addPlaceholder1>
                                <span class="material-icons" style="font-size: 20px;">add</span>
                                <span>Add</span>
                            </ng-template>
                            <input #galleryInput1 type="file" hidden
                                accept=".png,.jpg,.jpeg,.webp,image/png,image/jpeg,image/webp"
                                (change)="onGalleryFileChange($event, 0)">
                        </div>
                        <div class="gallery-slot" (click)="galleryInput2.click()">
                            <ng-container *ngIf="galleryImages[1]; else addPlaceholder2">
                                <img [src]="galleryImages[1]" class="gallery-preview" alt="Gallery image 2">
                            </ng-container>
                            <ng-template #addPlaceholder2>
                                <span class="material-icons" style="font-size: 20px;">add</span>
                                <span>Add</span>
                            </ng-template>
                            <input #galleryInput2 type="file" hidden
                                accept=".png,.jpg,.jpeg,.webp,image/png,image/jpeg,image/webp"
                                (change)="onGalleryFileChange($event, 1)">
                        </div>
                    </div>
                </div>

                <div class="color-section">
                    <p class="label-hint">No Images? Choose a fallback color:</p>
                    <div class="color-grid">
                        <div *ngFor="let color of colors" class="color-swatch" [style.background]="color.gradient"
                            [class.active]="state.offering().themeColor === color.value"
                            (click)="setThemeColor(color.value, color.gradient)">
                            <span *ngIf="state.offering().themeColor === color.value" class="material-icons"
                                style="font-size: 20px; color: white;">check</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right: Card Preview -->
        <div class="preview-column">
            <div class="preview-card">
                <h2 class="preview-label">Card Preview</h2>

                <!-- Inline Preview Card -->
                <div class="offering-preview-card">
                    <div class="preview-image-container"
                        [style.background]="state.offering().thumbnail ? 'transparent' : (state.offering().themeGradient || colors[0].gradient)">
                        <img *ngIf="state.offering().thumbnail" [src]="state.offering().thumbnail"
                            class="preview-card-image" alt="Offering thumbnail">
                    </div>

                    <div class="preview-content">
                        <h3 class="preview-title">{{ state.offering().name || 'Offering Name' }}</h3>

                        <p class="preview-tagline">{{ state.offering().tagline || 'Offering tagline' }}</p>

                        <ul class="preview-features"
                            *ngIf="state.previewFeatures().length > 0 && state.previewFeatures()[0] !== 'No features added'">
                            <li *ngFor="let feat of state.previewFeatures()">
                                <span class="bullet"></span>
                                {{ feat }}
                            </li>
                        </ul>

                        <div class="preview-footer">
                            <span class="tiers-badge">
                                +{{ state.offering().tiers.length }} Tier{{ state.offering().tiers.length !== 1 ? 's' :
                                '' }}
                            </span>
                        </div>

                        <div class="preview-price"
                            *ngIf="state.priceDisplay().isQuoteOnly || state.priceDisplay().min > 0">
                            <ng-container *ngIf="!state.priceDisplay().isQuoteOnly">
                                <!-- Single Price -->
                                <ng-container *ngIf="!state.priceDisplay().max">
                                    <span class="price-value">NZD {{ state.priceDisplay().min }}</span>
                                    <span class="price-period" *ngIf="state.priceDisplay().period">/{{
                                        state.priceDisplay().period }}</span>
                                </ng-container>

                                <!-- Price Range -->
                                <ng-container *ngIf="state.priceDisplay().max">
                                    <span class="price-value">NZD {{ state.priceDisplay().min }}</span>
                                    <span class="price-period" *ngIf="state.priceDisplay().period">/{{
                                        state.priceDisplay().period }}</span>
                                    <span class="price-separator">â€”</span>
                                    <span class="price-value">NZD {{ state.priceDisplay().max }}</span>
                                    <span class="price-period" *ngIf="state.priceDisplay().period">/{{
                                        state.priceDisplay().period }}</span>
                                </ng-container>
                            </ng-container>

                            <!-- Quote Only -->
                            <ng-container *ngIf="state.priceDisplay().isQuoteOnly">
                                <span class="price-value">Request Quote</span>
                            </ng-container>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>